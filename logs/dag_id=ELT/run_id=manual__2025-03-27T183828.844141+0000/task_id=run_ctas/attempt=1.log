[2025-03-27T18:38:32.959+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-03-27T18:38:32.974+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: ELT.run_ctas manual__2025-03-27T18:38:28.844141+00:00 [queued]>
[2025-03-27T18:38:32.983+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: ELT.run_ctas manual__2025-03-27T18:38:28.844141+00:00 [queued]>
[2025-03-27T18:38:33.026+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 1
[2025-03-27T18:38:33.129+0000] {taskinstance.py:2888} INFO - Executing <Task(_PythonDecoratedOperator): run_ctas> on 2025-03-27 18:38:28.844141+00:00
[2025-03-27T18:38:33.137+0000] {logging_mixin.py:190} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70 DeprecationWarning: This process (pid=336) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-03-27T18:38:33.138+0000] {standard_task_runner.py:72} INFO - Started process 339 to run task
[2025-03-27T18:38:33.137+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'ELT', 'run_ctas', 'manual__2025-03-27T18:38:28.844141+00:00', '--job-id', '47', '--raw', '--subdir', 'DAGS_FOLDER/HW6_ELT.py', '--cfg-path', '/tmp/tmpxtxtv308']
[2025-03-27T18:38:33.139+0000] {standard_task_runner.py:105} INFO - Job 47: Subtask run_ctas
[2025-03-27T18:38:33.231+0000] {task_command.py:467} INFO - Running <TaskInstance: ELT.run_ctas manual__2025-03-27T18:38:28.844141+00:00 [running]> on host 00cc07a75964
[2025-03-27T18:38:33.351+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='ELT' AIRFLOW_CTX_TASK_ID='run_ctas' AIRFLOW_CTX_EXECUTION_DATE='2025-03-27T18:38:28.844141+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-03-27T18:38:28.844141+00:00'
[2025-03-27T18:38:33.354+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-03-27T18:38:33.357+0000] {HW6_ELT.py:33} INFO - dev.analytics.session_summary
[2025-03-27T18:38:33.358+0000] {HW6_ELT.py:34} INFO - SELECT u.*, s.ts
    FROM DEV.RAW.user_session_channel u
    JOIN DEV.RAW.session_timestamp s ON u.sessionId=s.sessionId
    
[2025-03-27T18:38:33.375+0000] {base.py:84} INFO - Retrieving connection 'snowflake_conn'
[2025-03-27T18:38:33.377+0000] {connection.py:413} INFO - Snowflake Connector for Python Version: 3.12.1, Python Version: 3.12.5, Platform: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36
[2025-03-27T18:38:33.379+0000] {connection.py:1196} INFO - Connecting to GLOBAL Snowflake domain
[2025-03-27T18:38:33.382+0000] {connection.py:1277} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2025-03-27T18:38:34.268+0000] {cursor.py:1156} INFO - Number of results in first chunk: 1
[2025-03-27T18:38:34.269+0000] {HW6_ELT.py:43} INFO - CREATE OR REPLACE TABLE dev.analytics.session_summary AS SELECT u.*, s.ts
    FROM DEV.RAW.user_session_channel u
    JOIN DEV.RAW.session_timestamp s ON u.sessionId=s.sessionId
    
[2025-03-27T18:38:35.784+0000] {cursor.py:1156} INFO - Number of results in first chunk: 1
[2025-03-27T18:38:35.785+0000] {logging_mixin.py:190} INFO - SELECT sessionId, COUNT(1) AS cnt FROM dev.analytics.session_summary GROUP BY 1 ORDER BY 2 DESC LIMIT 1
[2025-03-27T18:38:36.024+0000] {cursor.py:1156} INFO - Number of results in first chunk: 1
[2025-03-27T18:38:36.029+0000] {logging_mixin.py:190} INFO - ('7cdace91c487558e27ce54df7cdb299c', 1) 1
[2025-03-27T18:38:36.030+0000] {HW6_ELT.py:58} INFO - Running duplicate check on analytics.session_summary
[2025-03-27T18:38:36.032+0000] {logging_mixin.py:190} INFO - SELECT COUNT(1) FROM analytics.session_summary
[2025-03-27T18:38:36.161+0000] {cursor.py:1156} INFO - Number of results in first chunk: 1
[2025-03-27T18:38:36.162+0000] {logging_mixin.py:190} INFO - 
            SELECT COUNT(1) FROM (
                SELECT DISTINCT * FROM analytics.session_summary
            )
        
[2025-03-27T18:38:36.451+0000] {cursor.py:1156} INFO - Number of results in first chunk: 1
[2025-03-27T18:38:36.572+0000] {cursor.py:1156} INFO - Number of results in first chunk: 1
[2025-03-27T18:38:36.573+0000] {python.py:240} INFO - Done. Returned value was: None
[2025-03-27T18:38:36.582+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-03-27T18:38:36.583+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=ELT, task_id=run_ctas, run_id=manual__2025-03-27T18:38:28.844141+00:00, execution_date=20250327T183828, start_date=20250327T183832, end_date=20250327T183836
[2025-03-27T18:38:36.633+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-03-27T18:38:36.652+0000] {taskinstance.py:3900} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-03-27T18:38:36.655+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
